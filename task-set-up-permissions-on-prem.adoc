---
sidebar: sidebar 
permalink: task-set-up-permissions-on-prem.html 
keywords: set up permissions, cloud permissions, aws permissions, azure permissions, on prem permissions, connector permissions 
summary: Wenn Sie BlueXP Services in AWS oder Azure mit einem On-Premises Connector nutzen möchten, müssen Sie Berechtigungen bei Ihrem Cloud-Provider einrichten, damit Sie nach der Installation die Zugangsdaten zum Connector hinzufügen können. 
---
= Cloud-Berechtigungen für On-Premises-Implementierungen einrichten
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Wenn Sie BlueXP Services in AWS oder Azure mit einem On-Premises Connector nutzen möchten, müssen Sie Berechtigungen bei Ihrem Cloud-Provider einrichten, damit Sie nach der Installation die Zugangsdaten zum Connector hinzufügen können.


TIP: Warum nicht Google Cloud? Der Connector kann vor Ort installiert werden und nicht Ihre Ressourcen in Google Cloud managen. Der Connector muss in Google Cloud installiert sein, um alle dort gespeicherten Ressourcen zu managen.

[role="tabbed-block"]
====
.AWS
--
Wenn der Connector vor Ort installiert ist, müssen Sie BlueXP mit AWS Berechtigungen versehen, indem Sie Zugriffsschlüssel für einen IAM-Benutzer mit den erforderlichen Berechtigungen hinzufügen.

Sie müssen diese Authentifizierungsmethode verwenden, wenn der Connector vor Ort installiert ist. Sie können keine IAM-Rolle verwenden.

.Schritte
. Erstellen Sie über die IAM-Konsole eine Richtlinie:
+
.. Klicken Sie auf *Richtlinien > Richtlinien erstellen*.
.. Wählen Sie *JSON* aus, kopieren Sie den Inhalt des link:reference-permissions-aws.html["IAM-Richtlinie für den Connector"].
.. Beenden Sie die verbleibenden Schritte, um die Richtlinie zu erstellen.
+
Abhängig von den BlueXP Services, die Sie planen zu verwenden, müssen Sie möglicherweise eine zweite Richtlinie erstellen.

+
Für Standardregionen werden die Berechtigungen auf zwei Richtlinien verteilt. Zwei Richtlinien sind aufgrund einer maximal zulässigen Zeichengröße für gemanagte Richtlinien in AWS erforderlich. link:reference-permissions-aws.html["Erfahren Sie mehr über IAM-Richtlinien für den Connector"].



. Fügen Sie die Richtlinien einem IAM-Benutzer hinzu.
+
** https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create.html["AWS Documentation: Erstellung von IAM-Rollen"^]
** https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html["AWS Dokumentation: Hinzufügen und Entfernen von IAM-Richtlinien"^]


. Stellen Sie sicher, dass der Benutzer über Zugriffsschlüssel verfügt, die Sie nach der Installation des Connectors zu BlueXP hinzufügen können.


.Ergebnis
Sie sollten nun über Zugriffsschlüssel für einen IAM-Benutzer verfügen, der über die erforderlichen Berechtigungen verfügt. Nach der Installation des Connectors müssen Sie diese Anmeldeinformationen mit dem Connector von BlueXP verknüpfen.

link:task-provide-permissions-on-prem.html["Erfahren Sie, wie Sie diese Berechtigungen für BlueXP bereitstellen"].

--
.Azure
--
Wenn der Connector vor Ort installiert ist, müssen Sie BlueXP mit Azure Berechtigungen versehen, indem Sie einen Service-Principal in Azure Active Directory einrichten und die für BlueXP erforderlichen Azure Zugangsdaten erhalten.

.Erstellen einer Azure Active Directory Applikation zur rollenbasierten Zugriffssteuerung
. Stellen Sie sicher, dass Sie in Azure über die Berechtigungen zum Erstellen einer Active Directory-Anwendung und zum Zuweisen der Anwendung zu einer Rolle verfügen.
+
Weitere Informationen finden Sie unter https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal#required-permissions/["Microsoft Azure-Dokumentation: Erforderliche Berechtigungen"^].

. Öffnen Sie über das Azure-Portal den *Azure Active Directory*-Service.
+
image:screenshot_azure_ad.gif["Zeigt den Active Directory-Dienst in Microsoft Azure an."]

. Klicken Sie im Menü auf *App-Registrierungen*.
. Klicken Sie auf *Neue Registrierung*.
. Geben Sie Details zur Anwendung an:
+
** *Name*: Geben Sie einen Namen für die Anwendung ein.
** *Kontotyp*: Wählen Sie einen Kontotyp aus (jeder kann mit BlueXP verwendet werden).
** *Redirect URI*: Sie können dieses Feld leer lassen.


. Klicken Sie Auf *Registrieren*.
+
Sie haben die AD-Anwendung und den Service-Principal erstellt.



.Anwendung einer Rolle zuweisen
. Erstellen einer benutzerdefinierten Rolle:
+
.. Kopieren Sie den Inhalt des link:reference-permissions-azure.html["Benutzerdefinierte Rollenberechtigungen für den Konnektor"] Und speichern Sie sie in einer JSON-Datei.
.. Ändern Sie die JSON-Datei, indem Sie dem zuweisbaren Bereich Azure-Abonnement-IDs hinzufügen.
+
Sie sollten die ID für jedes Azure Abonnement hinzufügen, aus dem Benutzer Cloud Volumes ONTAP Systeme erstellen.

+
*Beispiel*

+
[source, json]
----
"AssignableScopes": [
"/subscriptions/d333af45-0d07-4154-943d-c25fbzzzzzzz",
"/subscriptions/54b91999-b3e6-4599-908e-416e0zzzzzzz",
"/subscriptions/398e471c-3b42-4ae7-9b59-ce5bbzzzzzzz"
----
.. Verwenden Sie die JSON-Datei, um eine benutzerdefinierte Rolle in Azure zu erstellen.
+
In den folgenden Schritten wird beschrieben, wie die Rolle mithilfe von Bash in Azure Cloud Shell erstellt wird.

+
*** Starten https://docs.microsoft.com/en-us/azure/cloud-shell/overview["Azure Cloud Shell"^] Und wählen Sie die Bash-Umgebung.
*** Laden Sie die JSON-Datei hoch.
+
image:screenshot_azure_shell_upload.png["Einen Screenshot der Azure Cloud Shell, in dem Sie die Option zum Hochladen einer Datei auswählen können."]

*** Verwenden Sie die Azure CLI, um die benutzerdefinierte Rolle zu erstellen:
+
[source, azurecli]
----
az role definition create --role-definition Connector_Policy.json
----
+
Sie sollten nun eine benutzerdefinierte Rolle namens BlueXP Operator haben, die Sie der virtuellen Connector-Maschine zuweisen können.





. Applikation der Rolle zuweisen:
+
.. Öffnen Sie im Azure-Portal den Service *Abonnements*.
.. Wählen Sie das Abonnement aus.
.. Klicken Sie auf *Zugriffskontrolle (IAM) > Hinzufügen > Rollenzuweisung hinzufügen*.
.. Wählen Sie auf der Registerkarte * Role* die Rolle *BlueXP Operator* aus und klicken Sie auf *Next*.
.. Führen Sie auf der Registerkarte *Mitglieder* die folgenden Schritte aus:
+
*** *Benutzer, Gruppe oder Serviceprincipal* ausgewählt lassen.
*** Klicken Sie auf *Mitglieder auswählen*.
+
image:screenshot-azure-service-principal-role.png["Ein Screenshot des Azure-Portals, auf dem die Registerkarte Mitglieder angezeigt wird, wenn einer Anwendung eine Rolle hinzugefügt wird."]

*** Suchen Sie nach dem Namen der Anwendung.
+
Hier ein Beispiel:

+
image:screenshot_azure_service_principal_role.png["Ein Screenshot des Azure-Portals, in dem das Formular Rollenzuordnung hinzufügen im Azure-Portal angezeigt wird."]

*** Wählen Sie die Anwendung aus und klicken Sie auf *Auswählen*.
*** Klicken Sie Auf *Weiter*.


.. Klicken Sie auf *Review + Assign*.
+
Der Service-Principal verfügt jetzt über die erforderlichen Azure-Berechtigungen zur Bereitstellung des Connectors.

+
Wenn Sie Cloud Volumes ONTAP aus mehreren Azure Subscriptions bereitstellen möchten, müssen Sie den Service-Prinzipal an jedes dieser Subscriptions binden. Mit BlueXP können Sie das Abonnement auswählen, das Sie bei der Bereitstellung von Cloud Volumes ONTAP verwenden möchten.





.Fügen Sie Windows Azure Service Management-API-Berechtigungen hinzu
. Klicken Sie im *Azure Active Directory*-Dienst auf *App-Registrierungen* und wählen Sie die Anwendung aus.
. Klicken Sie auf *API-Berechtigungen > Berechtigung hinzufügen*.
. Wählen Sie unter *Microsoft APIs* *Azure Service Management* aus.
+
image:screenshot_azure_service_mgmt_apis.gif["Ein Screenshot des Azure Portals, in dem die Berechtigungen der Azure Service Management API angezeigt werden."]

. Klicken Sie auf *Zugriff auf Azure Service Management als Benutzer der Organisation* und dann auf *Berechtigungen hinzufügen*.
+
image:screenshot_azure_service_mgmt_apis_add.gif["Ein Screenshot des Azure Portals, in dem das Hinzufügen der Azure Service Management APIs angezeigt wird"]



.Die Anwendungs-ID und die Verzeichnis-ID für die Anwendung abrufen
. Klicken Sie im *Azure Active Directory*-Dienst auf *App-Registrierungen* und wählen Sie die Anwendung aus.
. Kopieren Sie die *Application (Client) ID* und die *Directory (Tenant) ID*.
+
image:screenshot_azure_app_ids.gif["Ein Screenshot, der die Anwendungs-ID (Client) und die Verzeichnis-ID (Mandant) für eine Anwendung in Azure Active Directory anzeigt"]

+
Wenn Sie das Azure-Konto zu BlueXP hinzufügen, müssen Sie die Anwendungs-ID (Client) und die Verzeichnis-ID (Mandant) für die Anwendung angeben. BlueXP verwendet die IDs, um sich programmatisch anzumelden.



.Erstellen Sie einen Clientschlüssel
. Öffnen Sie den Dienst *Azure Active Directory*.
. Klicken Sie auf *App-Registrierungen* und wählen Sie Ihre Anwendung aus.
. Klicken Sie auf *Zertifikate & Geheimnisse > Neuer Client Secret*.
. Geben Sie eine Beschreibung des Geheimnisses und eine Dauer an.
. Klicken Sie Auf *Hinzufügen*.
. Kopieren Sie den Wert des Clientgeheimnisses.
+
image:screenshot_azure_client_secret.gif["Ein Screenshot des Azure-Portals, in dem ein Client-Geheimnis für den Azure AD-Service-Principal angezeigt wird"]

+
Jetzt gibt es einen Client-Schlüssel, den BlueXP zur Authentifizierung mit Azure AD verwenden kann.



.Ergebnis
Ihr Service-Principal ist jetzt eingerichtet und Sie sollten die Anwendungs- (Client-)ID, die Verzeichnis- (Mandanten-)ID und den Wert des Clientgeheimnisses kopiert haben. Nach der Installation des Connectors müssen Sie diese Anmeldeinformationen mit dem Connector von BlueXP verknüpfen.

link:task-provide-permissions-on-prem.html["Erfahren Sie, wie Sie diese Berechtigungen für BlueXP bereitstellen"].

--
====